breaks = c("12", "1", "2"),
labels = c("December", "January", "February"))
w <- w + theme_set(theme_cowplot())
w
getwd()
save(c(adf, pdata), file = 'output/wdata.Rdata')
save((adf, pdata), file = 'output/wdata.Rdata')
save(adf, pdata, file = 'output/wdata.Rdata')
setwd('D:/Buren_files/GitHub/PG_Growth/')
load('output/wdata.Rdata')
adf
adf[1,]
pdata[1,]
library(cowplot)
w <- ggplot(adf, aes(length, weight, colour = as.factor(month)))
w <- w + geom_point(alpha = 0.5)
w <- w + geom_line(data = pdata, aes(length, predw, colour = as.factor(month)), size = 1.5)
w <- w + theme_bw()
w <- w + labs(x = 'Length (cm)', y = 'Weight (kg)')
w <- w + scale_colour_discrete(name = "",
breaks = c("12", "1", "2"),
labels = c("December", "January", "February"))
w <- w + theme_set(theme_cowplot())
w
source('D:/Buren_files/GitHub/PG_Growth/code/PG_conditionMMS_conditionfood.R', echo=TRUE)
with(subset(meancond, cohort_year > 1988 & capbiomass < 800), plot((capbiomass), meancond, pch = 16, xlim = c(0,1000)))
with(subset(meancond, cohort_year > 1988 & capbiomass < 800), plot((capbiomass), meancond, pch = 16, xlim = c(0,1000)))
with(subset(meancond, cohort_year > 1988 & capbiomass < 800), plot(log(capbiomass), meancond, pch = 16)
with(meancond, points(log(capbiomass), meancond, pch = 16, col = 'red'))
meancond$ilmeancond <- gtools::inv.logit(meancond$meancond)
with(subset(meancond, cohort_year > 1988 & capbiomass < 800), plot(log(capbiomass), meancond, pch = 16)
with(meancond, points(log(capbiomass), meancond, pch = 16, col = 'red'))
meancond$ilmeancond <- gtools::inv.logit(meancond$meancond)
with(subset(meancond, cohort_year > 1988 & capbiomass < 800), plot(log(capbiomass), meancond, pch = 16))
source('D:/Buren_files/GitHub/PG_Growth/code/PG_conditionMMS_conditionfood.R', echo=TRUE)
with(meancond, cor.test(capbiomass, meancond))
with(meancond, cor.test(log(capbiomass), meancond))
meancond
with(meancond, cor.test(log(capbiomass), ilmeancond))
with(meancond, cor.test((capbiomass), ilmeancond))
fecun
meancond
merge(meancond, fecun, by = 'cohort_year', all = T)
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
mm
names(mm)
pairs(c(mm[,c('ice.1y.jan','Capt1','ArcCodt1','Sandt1','meancond', 'totpop', 'capbiomass')]),upper.panel=points, lower.panel=panelcor,diag.panel=panel.hist)
pairs(c(mm[,c('meancond','ice.1y.jan','Capt1','ArcCodt1','Sandt1', 'totpop', 'capbiomass')]),upper.panel=points, lower.panel=panelcor,diag.panel=panel.hist)
gam(meancond ~ s(Capt1) + s(ArcCodt1) + ice.1y.jan, data = mm)
gam(meancond ~ s(Capt1)  + ice.1y.jan, data = mm)
m1 <- gam(meancond ~ s(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ s(ArcCodt1)  + ice.1y.jan, data = mm)
anova(m1, m2)
plot(m1)
plot(m2)
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
anova(m1, m2)
plot(m2)
plot(m1)
fitted(m1)
plot(mm$cohort_year, mm$meancond)
lines(mm$cohort_year, fitted(m1), col = 'blue')
dim(mm)
mm
predict(m1, newdata = mm)
plot(mm$cohort_year, mm$meancond)
lines(mm$cohort_year, mm$E1, col = 'blue')
lines(mm$cohort_year, mm$E2, col = 'red')
mm
mm[,c('meancond')]
mm[,c('meancond','Em1')]
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
plot(mm$cohort_year, mm$meancond)
lines(mm$cohort_year, mm$E1, col = 'blue')
lines(mm$cohort_year, mm$E2, col = 'red')
mm$E1
plot(mm$cohort_year, mm$meancond)
lines(mm$cohort_year, mm$Em1, col = 'blue')
lines(mm$cohort_year, mm$Em2, col = 'red')
summary(m1)
summary(m2)
plot(mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines(mm$cohort_year, mm$Em1, col = 'blue')
points(mm$cohort_year, mm$meancond, pch = 16)
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
m4
plot(mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines(mm$cohort_year, mm$Em1, col = 'blue')
lines(mm$cohort_year, mm$Em3, col = 'darkgreen')
lines(mm$cohort_year, mm$Em4, col = 'purple')
points(mm$cohort_year, mm$meancond, pch = 16)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
plot(mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines(mm$cohort_year, mm$Em1, col = 'blue')
lines(mm$cohort_year, mm$Em3, col = 'darkgreen')
lines(mm$cohort_year, mm$Em4, col = 'purple')
points(mm$cohort_year, mm$meancond, pch = 16)
plot(m4)
anova(m1,m2,m3,m4)
mm
mm <- na.omit(mm[,c('meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
plot(mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines(mm$cohort_year, mm$Em1, col = 'blue')
lines(mm$cohort_year, mm$Em3, col = 'darkgreen')
mm$Em1 <- predict(m1, newdata = mm)
m1
plot(mm$cohort_year, mm$Em2, col = 'red', type ='l')
m1
m2
summary(m1)
summary(m1)
summary(m2)
summary(m3)
summary(m4)
mm <- na.omit(mm[,c('meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
mm[1,]
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em1, col = 'blue')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em4, col = 'purple')
points(mm$cohort_year, mm$meancond, pch = 16)
mm$Em5 <- predict(m5, newdata = mm)
m5 <- gam(meancond ~ te(Capt1) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em1, col = 'blue')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em5, col = 'orange')
lines (mm$cohort_year, mm$Em4, col = 'purple')
points(mm$cohort_year, mm$meancond, pch = 16)
m5 <- gam(meancond ~ te(ice.1y.jan, Capt1) , data = mm)
m5 <- gam(meancond ~ te(ice.1y.jan) + Capt1 , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em4, col = 'purple')
points(mm$cohort_year, mm$meancond, pch = 16)
lines (mm$cohort_year, mm$Em5, col = 'orange')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em1, col = 'blue')
summary(m5)
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em4, col = 'purple')
lines (mm$cohort_year, mm$Em5, col = 'orange')
points(mm$cohort_year, mm$meancond, pch = 16)
mm$Em5 <- predict(m5, newdata = mm)
lines (mm$cohort_year, mm$Em1, col = 'blue')
m5 <- gam(meancond ~ te(ice.1y.jan) + ArcCodt1 , data = mm)
mm$Em2 <- predict(m2, newdata = mm)
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
m5 <- gam(meancond ~ te(ice.1y.jan) + ArcCodt1 , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em1, col = 'blue')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em4, col = 'purple')
lines (mm$cohort_year, mm$Em5, col = 'orange')
points(mm$cohort_year, mm$meancond, pch = 16)
summary(m1)
summary(m5)
summary(m2)
summary(m2)
summary(m3)
summary(m5)
mm
meancond
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc')])
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc')])
mm
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Cohort year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
pairs(c(mm[,c('meancond','ice.1y.jan','Capt1','ArcCodt1','Sandt1', 'totpop', 'capbiomass')]),upper.panel=points, lower.panel=panelcor,diag.panel=panel.hist)
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
m5 <- gam(meancond ~ te(ice.1y.jan) + ArcCodt1 , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
plot  (mm$cohort_year, mm$Em2, col = 'red', type ='l')
lines (mm$cohort_year, mm$Em1, col = 'blue')
lines (mm$cohort_year, mm$Em3, col = 'darkgreen')
lines (mm$cohort_year, mm$Em4, col = 'purple')
lines (mm$cohort_year, mm$Em5, col = 'orange')
points(mm$cohort_year, mm$meancond, pch = 16)
## plot condition ----
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'orange')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + geom_line(aes(cohort_year, Em3), colour = 'darkgreen')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
meancond[1,]
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc', 'capbiomass')])
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
pairs(c(mm[,c('meancond','ice.1y.jan','Capt1','ArcCodt1','Sandt1', 'totpop', 'capbiomass')]),upper.panel=points, lower.panel=panelcor,diag.panel=panel.hist)
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc', 'capbiomass')])
mm
m6 <- gam(meancond ~ te(capbiomass) , data = mm)
summary(m6)
m6 <- gam(meancond ~ te(log(capbiomass)) , data = mm)
summary(m6)
se <- predict( m1 , se = TRUE)$se.fit
mm$pred1lb <- mm$pred1 - 1.96 * se
mm$pred1ub <- mm$pred1 + 1.96 * se
se <- predict( m2 , se = TRUE)$se.fit
mm$pred2lb <- mm$pred2 - 1.96 * se
mm$pred2ub <- mm$pred2 + 1.96 * se
se <- predict( m3 , se = TRUE)$se.fit
mm$pred3lb <- mm$pred3 - 1.96 * se
mm$pred3ub <- mm$pred3 + 1.96 * se
se <- predict( m4 , se = TRUE)$se.fit
mm$pred4lb <- mm$pred4 - 1.96 * se
mm$pred4ub <- mm$pred4 + 1.96 * se
se <- predict( m5 , se = TRUE)$se.fit
mm$pred5lb <- mm$pred5 - 1.96 * se
mm$pred5ub <- mm$pred5 + 1.96 * se
se <- predict( m1 , se = TRUE, newdata = mm)$se.fit
mm$pred1lb <- mm$pred1 - 1.96 * se
se
length(se)
dim(mm)
mm
se <- predict( m1 , se = TRUE, newdata = mm)$se.fit
mm$pred1lb <- mm$pred1 - 1.96 * se
se <- predict( m1 , se = TRUE, newdata = mm)$se.fit
mm$Em1lb <- mm$Em1 - 1.96 * se
mm$Em1ub <- mm$Em1 + 1.96 * se
se <- predict( m2 , se = TRUE)$se.fit
mm$Em2lb <- mm$Em2 - 1.96 * se
mm$Em2ub <- mm$Em2 + 1.96 * se
se <- predict( m3 , se = TRUE)$se.fit
mm$Em3lb <- mm$Em3 - 1.96 * se
mm$Em3ub <- mm$Em3 + 1.96 * se
se <- predict( m4 , se = TRUE)$se.fit
mm$Em4lb <- mm$Em4 - 1.96 * se
mm$Em4ub <- mm$Em4 + 1.96 * se
se <- predict( m5 , se = TRUE)$se.fit
mm$Em5lb <- mm$Em5 - 1.96 * se
mm$Em5ub <- mm$Em5 + 1.96 * se
se
mm
mm$Em1
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
mm
se <- predict( m1 , se = TRUE, newdata = mm)$se.fit
meancond$ilmeancond <- gtools::inv.logit(meancond$meancond)
mm <- merge(meancond, fecun, by = 'cohort_year', all = T)
pairs(c(mm[,c('meancond','ice.1y.jan','Capt1','ArcCodt1','Sandt1', 'totpop', 'capbiomass')]),upper.panel=points, lower.panel=panelcor,diag.panel=panel.hist)
mm <- na.omit(mm[,c('cohort_year', 'meancond', 'Capt1', 'ArcCodt1', 'ice.1y.jan', 'lcc', 'ucc', 'capbiomass')])
m1 <- gam(meancond ~ te(Capt1)  + ice.1y.jan, data = mm)
m2 <- gam(meancond ~ te(ArcCodt1)  + ice.1y.jan, data = mm)
m3 <- gam(meancond ~ te(ArcCodt1) , data = mm)
m4 <- gam(meancond ~ te(ice.1y.jan) , data = mm)
m5 <- gam(meancond ~ te(ice.1y.jan) + ArcCodt1 , data = mm)
m6 <- gam(meancond ~ te(log(capbiomass)) , data = mm)
mm$Em1 <- predict(m1, newdata = mm)
mm$Em2 <- predict(m2, newdata = mm)
mm$Em3 <- predict(m3, newdata = mm)
mm$Em4 <- predict(m4, newdata = mm)
mm$Em5 <- predict(m5, newdata = mm)
se <- predict( m1 , se = TRUE)$se.fit
mm$Em1lb <- mm$Em1 - 1.96 * se
mm$Em1ub <- mm$Em1 + 1.96 * se
se <- predict( m2 , se = TRUE)$se.fit
mm$Em2lb <- mm$Em2 - 1.96 * se
mm$Em2ub <- mm$Em2 + 1.96 * se
se <- predict( m3 , se = TRUE)$se.fit
mm$Em3lb <- mm$Em3 - 1.96 * se
mm$Em3ub <- mm$Em3 + 1.96 * se
se <- predict( m4 , se = TRUE)$se.fit
mm$Em4lb <- mm$Em4 - 1.96 * se
mm$Em4ub <- mm$Em4 + 1.96 * se
se <- predict( m5 , se = TRUE)$se.fit
mm$Em5lb <- mm$Em5 - 1.96 * se
mm$Em5ub <- mm$Em5 + 1.96 * se
mm
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + geom_line(aes(cohort_year, Em3), colour = 'darkgreen')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + geom_line(aes(cohort_year, Em3), colour = 'darkgreen')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em3lb, ymax = Em3ub), alpha = 0.2, fill = 'darkgreen')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + theme_set(theme_cowplot())
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_point()
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay
ay
mm
ay <- ay + annotate("text", x = 1997, y = 0.75, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 2.6)
ay <- ay + annotate("text", x = 1997, y = 0.7, label = "condition ~ gam(ice.1y.jan + smooth(ArcCodt1)", hjust = 0, size = 2.6)
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.75, yend = 0.75, colour = "red")
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.7, yend = 0.7, colour = "blue")
ay
ay <- ay + annotate("text", x = 1997, y = 0.65, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 2.6)
ay
ay <- ay + annotate("text", x = 1997, y = 0.6, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 2.6)
ay
## plot condition ----
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
#ay <- ay + geom_line(aes(cohort_year, Em3), colour = 'darkgreen')
# ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
# ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
#ay <- ay + geom_ribbon(data = mm, aes(ymin = Em3lb, ymax = Em3ub), alpha = 0.2, fill = 'darkgreen')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay <- ay + annotate("text", x = 1997, y = 0.6, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 2.6)
ay <- ay + annotate("text", x = 1997, y = 0.65, label = "condition ~ gam(ice.1y.jan + smooth(ArcCodt1)", hjust = 0, size = 2.6)
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.6, yend = 0.6, colour = "red")
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.65, yend = 0.65, colour = "blue")
ay
## plot condition ----
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
#ay <- ay + geom_line(aes(cohort_year, Em3), colour = 'darkgreen')
# ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
# ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
#ay <- ay + geom_ribbon(data = mm, aes(ymin = Em3lb, ymax = Em3ub), alpha = 0.2, fill = 'darkgreen')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Condition')
ay <- ay + annotate("text", x = 1997, y = 0.6, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 3)
ay <- ay + annotate("text", x = 1997, y = 0.65, label = "condition ~ gam(ice.1y.jan + smooth(ArcCodt1)", hjust = 0, size = 3)
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.6, yend = 0.6, colour = "red")
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.65, yend = 0.65, colour = "blue")
ay
## plot condition ----
ay <- ggplot(mm, aes(cohort_year, meancond))
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em5lb, ymax = Em5ub), alpha = 0.2, fill = 'red')
ay <- ay + geom_ribbon(data = mm, aes(ymin = Em2lb, ymax = Em2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = lcc, ymax = ucc))
ay <- ay + geom_line(aes(cohort_year, Em5), colour = 'red')
ay <- ay + geom_line(aes(cohort_year, Em2), colour = 'blue')
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Condition')
ay <- ay + annotate("text", x = 1997, y = 0.6, label = "condition ~ gam(smooth(ice.1y.jan) + ArcCodt1)", hjust = 0, size = 3)
ay <- ay + annotate("text", x = 1997, y = 0.65, label = "condition ~ gam(ice.1y.jan + smooth(ArcCodt1)", hjust = 0, size = 3)
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.6, yend = 0.6, colour = "red")
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.65, yend = 0.65, colour = "blue")
save_plot("output/condition-models.png", ay, base_aspect_ratio = 1, base_height = 6) # make room for figure legend)
save_plot("output/condition-models.png", ay, base_aspect_ratio = 1, base_height = 4, base_width = 6) # make room for figure legend)
source('D:/Buren_files/GitHub/PG_Growth/code/PG_conditionMMS_abortion.R', echo=TRUE)
ay <- ggplot(plotfecun, aes(cohort_year, abrate))
ay <- ay + geom_point()
ay <- ay + geom_linerange(aes(ymin = ablb, ymax = abub))
ay <- ay + theme_set(theme_cowplot())
ay <- ay + labs(x = 'Year', y = 'Abortion rate')
ay <- ay + geom_line(data = plotfecun, aes(x = cohort_year, y = pred1), col = 'red')
ay <- ay + geom_line(data = plotfecun, aes(x = cohort_year, y = pred2), col = 'blue')
ay <- ay + geom_point(data = plotfecun, aes(x = cohort_year, y = pred2), col = 'blue', pch = 16, size = 1.3)
ay <- ay + geom_point(data = plotfecun, aes(x = cohort_year, y = pred1), col = 'red', pch = 16, size = 1.3)
ay <- ay + geom_ribbon(data = plotfecun, aes(ymin = pred2lb, ymax = pred2ub), alpha = 0.2, fill = 'blue')
ay <- ay + geom_ribbon(data = plotfecun, aes(ymin = pred1lb, ymax = pred1ub), alpha = 0.2, fill = 'red')
ay <- ay + annotate("text", x = 1997, y = 0.6, label = "Abortion rate ~ gam(condition)", hjust = 0, size = 2.6)
ay <- ay + annotate("text", x = 1997, y = 0.58, label = "Abortion rate ~ betareg(Capelin + January ice)", hjust = 0, size = 2.6)
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.6, yend = 0.6, colour = "red")
ay <- ay + annotate("segment", x = 1996, xend = 1996.8, y = 0.58, yend = 0.58, colour = "blue")
save_plot("output/abortion-models.png", ay, base_aspect_ratio = 1, base_height = 4, base_width = 6) # make room for figure legend)
